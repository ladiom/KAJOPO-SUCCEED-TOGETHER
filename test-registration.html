<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test User Registration - K√°j·ªçp·ªçÃÄ Connect</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full">
        <h1 class="text-2xl font-bold mb-6 text-center">Test User Registration</h1>
        
        <form id="testForm" class="space-y-4">
            <div>
                <label class="block text-sm font-medium mb-1">First Name</label>
                <input type="text" id="firstName" value="John" class="w-full border rounded px-3 py-2" required>
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Last Name</label>
                <input type="text" id="lastName" value="Doe" class="w-full border rounded px-3 py-2" required>
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Email</label>
                <input type="email" id="email" value="john.doe@example.com" class="w-full border rounded px-3 py-2" required>
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Account Type</label>
                <select id="accountType" class="w-full border rounded px-3 py-2" required>
                    <option value="seeker">Opportunity Seeker</option>
                    <option value="provider">Opportunity Provider</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Organization</label>
                <input type="text" id="organization" value="Test Organization" class="w-full border rounded px-3 py-2">
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Phone</label>
                <input type="tel" id="phone" value="+1234567890" class="w-full border rounded px-3 py-2">
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Location</label>
                <input type="text" id="location" value="Test City" class="w-full border rounded px-3 py-2">
            </div>
            
            <button type="submit" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">
                Register Test User
            </button>
        </form>
        
        <div class="mt-6 space-y-2">
            <button onclick="checkLocalStorage()" class="w-full bg-green-500 text-white py-2 rounded hover:bg-green-600">
                Check localStorage
            </button>
            <button onclick="openAdminPanel()" class="w-full bg-purple-500 text-white py-2 rounded hover:bg-purple-600">
                Open Admin Panel
            </button>
            <button onclick="clearTestData()" class="w-full bg-red-500 text-white py-2 rounded hover:bg-red-600">
                Clear Test Data
            </button>
        </div>
        
        <div id="result" class="mt-4 p-4 bg-gray-100 rounded text-sm hidden"></div>
    </div>

    <script>
        function generateUserId() {
            return 'user_' + Math.random().toString(36).substr(2, 9);
        }

        document.getElementById('testForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userData = {
                id: generateUserId(),
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                accountType: document.getElementById('accountType').value,
                organization: document.getElementById('organization').value,
                phone: document.getElementById('phone').value,
                location: document.getElementById('location').value,
                registeredAt: new Date().toISOString(),
                isVerified: false,
                profileComplete: false
            };
            
            // Store user data using the same method as registration-form.html
            const userKey = `kajopo_user_${userData.id}`;
            localStorage.setItem(userKey, JSON.stringify(userData));
            
            // Also keep the main user key for backward compatibility
            localStorage.setItem('kajopo_user', JSON.stringify(userData));
            
            showResult(`‚úÖ Test user registered successfully!\n\nUser ID: ${userData.id}\nStorage Key: ${userKey}\n\nNow check the admin panel to see if the user appears.`, 'success');
        });

        function checkLocalStorage() {
            const allKeys = Object.keys(localStorage);
            const userKeys = allKeys.filter(key => key.includes('kajopo_user') || key.includes('userInfo'));
            
            let result = `Found ${userKeys.length} user-related keys in localStorage:\n\n`;
            
            userKeys.forEach(key => {
                try {
                    const userData = JSON.parse(localStorage.getItem(key));
                    result += `Key: ${key}\n`;
                    result += `Name: ${userData.firstName} ${userData.lastName}\n`;
                    result += `Email: ${userData.email}\n`;
                    result += `Type: ${userData.accountType}\n`;
                    result += `Verified: ${userData.isVerified}\n\n`;
                } catch (e) {
                    result += `Key: ${key} (invalid JSON)\n\n`;
                }
            });
            
            showResult(result, 'info');
        }

        function openAdminPanel() {
            window.open('admin-dashboard.html', '_blank');
        }

        function clearTestData() {
            const allKeys = Object.keys(localStorage);
            const userKeys = allKeys.filter(key => key.includes('kajopo_user'));
            
            userKeys.forEach(key => {
                localStorage.removeItem(key);
            });
            
            showResult(`üóëÔ∏è Cleared ${userKeys.length} user records from localStorage.`, 'warning');
        }

        function showResult(message, type) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = `mt-4 p-4 rounded text-sm ${
                type === 'success' ? 'bg-green-100 text-green-800' :
                type === 'warning' ? 'bg-yellow-100 text-yellow-800' :
                type === 'error' ? 'bg-red-100 text-red-800' :
                'bg-gray-100 text-gray-800'
            }`;
            resultDiv.innerHTML = message.replace(/\n/g, '<br>');
            resultDiv.classList.remove('hidden');
        }
    </script>
</body>
</html>